function TNStats_Tracker(e){this._domain=e;this._trackerDomain="stats.townnews.com";this._trackerURI="/shared-content/stats/common/tracker.gif";this._plugins=["DetectFlash","DetectRes","DetectVisitor","DetectPageTitle"];this._globalvars=[];this._trackvars=[];this._uriPrefix="";this._sessionTimeout=1800;this._cookieTimeout=43800;this._pageStart=new Date();this._ignoreURI=[];this._ignoreURI["/shared-content/firebuglite/firebug.html"]=1;this._cookiePath="/";this._crossDomainMessenger=false;this.crossDomain=true;if(document.getElementsByTagName){var c=document.getElementsByTagName("meta");for(var d=0;d<c.length;d++){if(c[d].name!=="murlinstats"){continue}if(c[d].content.substr(0,6)==="ignore"){var b=c[d].content.substr(7).split(",");for(var a=0;a<b.length;a++){this._ignoreURI[b[a]]=1}}}}this._setGlobalVar=function(g,f){this._globalvars[g]=f};this._getGlobalVar=function(f){if(this._globalvars[f]){return this._globalvars[f]}return""};this._addTrackVar=function(g,f){g=escape(g);f=escape(f);this._trackvars[g]=f};this._clearTrackVars=function(){this._trackvars=[]};this._joinGlobalVars=function(){var f=[];for(var g in this._globalvars){if(typeof(this._globalvars[g])==="string"){f[f.length]=(escape(g)+"="+escape(this._globalvars[g]))}}return f.join("&")};this._joinTrackVars=function(){var f=[];for(var g in this._trackvars){if(typeof(this._trackvars[g])==="string"){f[f.length]=(g+"="+this._trackvars[g])}}return f.join("&")};this._addCookie=function(m,g,f){if(typeof(sessionStorage)!=="undefined"&&typeof(localStorage)!=="undefined"){var k=(f)?localStorage:sessionStorage;try{k["tnms:"+this._domain+":"+m]=g}catch(h){k.clear()}}else{var j=m+"="+escape(g)+"; path="+this._cookiePath+";";if(f>0){var l=new Date();var i=l.getTime();l.setTime((f*3600*1000)+i);j=j+" expires="+l.toGMTString()+";"}document.cookie=j}};this._getCookie=function(k){var f=document.cookie;var h=f.split("; ");var i="";for(var j=0;j<h.length;j++){var g=h[j].split("=");if(g[0]===k){i=unescape(g[1]);break}}if(typeof(sessionStorage)!=="undefined"&&typeof(localStorage)!=="undefined"){if(localStorage["tnms:"+this._domain+":"+k]){i=localStorage["tnms:"+this._domain+":"+k]}if(sessionStorage["tnms:"+this._domain+":"+k]){i=sessionStorage["tnms:"+this._domain+":"+k]}}return i};this._sendTracker=function(){var h=new Date();var g="";if(window.location.protocol.indexOf("http:")===0?"s":""){g="http://"+this._trackerDomain+this._trackerURI}else{g="https://"+this._trackerDomain+this._trackerURI}g=g+"?"+this._joinTrackVars()+"&rt="+h.getTime();var f=new Image(1,1);f.src=g}}TNStats_Tracker.prototype.setTracker=function(){};TNStats_Tracker.prototype.setTrackerDomain=function(a){this._trackerDomain=a};TNStats_Tracker.prototype.setTrackerURI=function(a){this._trackerURI=a};TNStats_Tracker.prototype.setURIPrefix=function(a){this._uriPrefix=a};TNStats_Tracker.prototype.ignoreURI=function(b,a){if(!a){this._ignoreURI[b]=1}else{this._ignoreURI[a+"-"+b]=1}};TNStats_Tracker.prototype.pluginDetectRes=function(){if(screen){this._addTrackVar("tnms_rs",screen.width+"x"+screen.height+"x"+screen.colorDepth)}};TNStats_Tracker.prototype.pluginDetectPageTitle=function(){var a=this._getCookie("tnms_pdt");var b=this._getGlobalVar("title");if(!b.length){b="(empty title)"}if(a){this._addTrackVar("tnms_pdt",a)}this._addTrackVar("tnms_dt",b);this._addCookie("tnms_pdt",b,this._cookieTimeout)};TNStats_Tracker.prototype.pluginDetectVisitor=function(){var b=new Date();var c=0;var h=String(this._getCookie("tnms_vid"));var e=this._getCookie("tnms_vsst");var d=this._getCookie("tnms_vssl");var f=this._getCookie("tnms_vpuri");var g=0;if(!h.length){c=1;e=b.getTime()/1000;h+=b.getTime();if(window.screenX){h+=Math.abs(window.screenX)}else{if(window.screenLeft){h+=Math.abs(window.screenLeft)}}if(window.screenX){h+=Math.abs(window.screenY)}else{if(window.screenTop){h+=Math.abs(window.screenTop)}}if(document.body&&document.body.clientWidth){h+=document.body.clientWidth}else{if(window.innerWidth){h+=window.innerWidth}}if(document.body&&document.body.clientHeight){h+=document.body.clientHeight}else{if(window.innerHeight){h+=window.innerHeight}}h+=Math.floor(Math.random()*b.getTime())}else{if((!e)||(((b.getTime()/1000)-d)>this._sessionTimeout)){c=2;e=b.getTime()/1000}}this._addCookie("tnms_vsst",Math.ceil(e));this._addCookie("tnms_vssl",Math.ceil((b.getTime()/1000)));this._addCookie("tnms_vpuri",this._uri,this._cookieTimeout);this._addCookie("tnms_vid",h,this._cookieTimeout);var i=this._getCookie("tnms_vtumt");var a=String(b.getFullYear())+String(b.getMonth());if(i!==a){this._addTrackVar("tnms_vtum",1);this._addCookie("tnms_vtumt",a,this._cookieTimeout)}if(d){this._addTrackVar("tnms_vpuri",f);if(c){g=0}else{g=(b.getTime()/1000)-d}this._addTrackVar("tnms_vplen",Math.ceil(g))}this._addTrackVar("tnms_vt",c);this._addTrackVar("tnms_vid",h)};TNStats_Tracker.prototype.pluginDetectFlash=function(){var c=false;var d="";var b;if(navigator.plugins["Shockwave Flash"]&&navigator.plugins["Shockwave Flash"].description){d=String(navigator.plugins["Shockwave Flash"].description);b=d.split(" ");c=b[2]}else{if(window.ActiveXObject){var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.5");if(a){d=String(a.GetVariable("$version"));b=d.split(/[, ]/);c=b[1]+"."+b[2]}}}if(c){this._addTrackVar("tnms_fl",c)}};TNStats_Tracker.prototype.runPlugins=function(){for(var $x=0;$x<this._plugins.length;$x++){if(!this._ignoreURI[this._plugins[$x]+"-"+this._uri]){try{eval("this.plugin"+this._plugins[$x]+"();")}catch(e){}}}this._addTrackVar("tnms_do",this._domain);this._addTrackVar("tnms_uri",this._uri);this._addTrackVar("tnms_ref",this._getGlobalVar("referrer"));this._sendTracker()};TNStats_Tracker.prototype.trackPageView=function(b){var g=String(document.location);var e=g.match(/^(http|https):\/\/([^\/]{1,})(.*)$/);this._clearTrackVars();if(e){this._uri=this._uriPrefix+e[3];this._scheme=e[1]}if(b){this._uri=this._uriPrefix+b}if(this._ignoreURI[this._uri]){return}this._setGlobalVar("title",document.title);this._setGlobalVar("referrer",document.referrer);this._setGlobalVar("domain",this._domain);this._setGlobalVar("uri",this._uri);if(document.createElement&&this.crossDomain){if(!this._crossDomainMessenger){this._crossDomainMessenger=true;var f=window.addEventListener?"addEventListener":"attachEvent";var c=window[f];var a=f==="attachEvent"?"onmessage":"message";if(c){c(a,function(j){if(j.origin&&j.data&&j.data.tnms_event&&j.data.tnms_event==="trackPageview"&&j.data.tnms_domain&&j.data.tnms_uri){var k=j.origin.replace(/.*?:\/\//g,"");var i=new TNStats_Tracker(j.data.tnms_domain);i.crossDomain=false;i.setTrackerDomain(k);i.trackPageView(j.data.tnms_uri)}},false)}}var d=document.createElement("iframe");if(d&&d.src!==undefined){var h=this._scheme+"://"+this._trackerDomain+"/"+this._domain+"/?"+this._joinGlobalVars();document.write('<iframe src="'+h+'" width="0" height="0" frameBorder="0" style="position: absolute; width: 0px; height: 0px;"></iframe>')}else{this.runPlugins()}}else{this.runPlugins()}};TNStats_Tracker.prototype.trackPageViewCD=function(){var g=String(document.location);var b=g.match(/\?(.*)$/);if(!b||!b[1]){return}var i=b[1].split("&");for(var h=0;h<i.length;h++){var d=i[h].split("=");var c=unescape(d[0]);var a=unescape(d[1]);this._setGlobalVar(c,a);if(c==="uri"){this._uri=a}else{if(c==="domain"){this._domain=a}}}if(!this._uri||!this._domain){return}if(parent&&parent.postMessage){try{this._addCookie("tnms_cdc","1",1)}catch(f){parent.postMessage({tnms_event:"trackPageview",tnms_uri:this._uri,tnms_domain:this._domain},"*");return}}this._cookiePath="/"+this._domain+"/";this.runPlugins()};